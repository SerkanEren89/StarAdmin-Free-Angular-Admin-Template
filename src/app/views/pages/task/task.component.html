<div class="row title-container">
  <div class="col-xl-6 col-lg-6 col-md-6 col-sm-12 parent">
    <span class="input-group-text text-primary title">
    <img class="mdi mdi-cube icon-lg category-icon side-icon" src="assets/svg/task.svg">
    Task
    </span>
  </div>
</div>

<div class="row" *ngIf="tasks.length > 0">
  <div class="col-lg-12 grid-margin">
    <div class="card">
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-bordered" #taskTable>
            <thead>
            <tr>
              <th>
                Assigned
              </th>
              <th>
                Created
              </th>
              <th>
                Finished
              </th>
              <th>
                Content
              </th>
              <th>
                Note
              </th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let task of tasks">
              <td>
                {{task.employee.firstName}} {{task.employee.lastName}}
              </td>
              <td>
                {{task.creationDate | date:'dd/MM/yyyy'}}
              </td>
              <td>
                {{task.endDate | date:'dd/MM/yyyy'}}
              </td>
              <td class="text comment full"
                  (click)="openDetailPopup(task, contentTaskDetail)"
                  *ngIf="task.comment.content != null && task.comment.content.length <= 100">
                {{task.comment.content}}
              </td>
              <td class="text comment full"
                  (click)="openDetailPopup(task, contentTaskDetail)"
                  *ngIf="task.comment.content != null && task.comment.content.length > 100">
                {{task.comment.content | slice:0:100}}...
              </td>
              <td>
                {{task.description}}
              </td>
            </tr>
            </tbody>
          </table>
          <ngb-pagination [collectionSize]="totalElements" [pageSize]="pageSize" [page]="page"
                          (pageChange)="loadTasks($event)"
                          [maxSize]="3" [rotate]="true" [ellipses]="false" [boundaryLinks]="true"
                          aria-label="Default pagination" class="d-flex pagination justify-content-end pagination-success"></ngb-pagination>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row" *ngIf="tasks.length == 0">
  <div class="col-lg-12 grid-margin">
    <div class="card">
      <div class="card-body">
        <div class="table-responsive empty-text">
          <i class="fa fa-exclamation-triangle icon-md text-danger"></i> You didn't create any task yet
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #contentTaskDetail let-modalReview>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-comment-detail">Assigned Task</h4>
    <button type="button" class="close" aria-label="Close" (click)="modalReview.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="summary-container">
      <div class="summary">
        <div class="assignee-container">
          <div class="detail-container status">
            <p class="written">Created at: {{selectedTask.creationDate  | date:'dd/MM/yyyy'}}</p>
            <p class="written author">Assigned to: {{selectedTask.employee.firstName }} {{selectedTask.employee.lastName }}</p>
          </div>
          <p class="written finished" *ngIf="selectedTask.endDate != null">
            Finished: {{selectedTask.creationDate  | date:'dd/MM/yyyy'}}
            <i class="fa fa-check-circle"></i>
          </p>
        </div>
        <p class="content-comment">{{selectedTask.comment.content}}</p>
        <div class="content-container" *ngIf="selectedTask.comment.translatedText != null">
          <p class="text-danger content-title">Translated Review: </p>
          <p class="content-answer">{{selectedTask.comment.translatedText}}</p>
        </div>
        <div class="detail-container">
          <app-channel-icon [source]="selectedTask.comment.source.toLowerCase()"></app-channel-icon>
          <p class="written" >Written By: {{selectedTask.comment.author}}</p>
          <p class="written">{{selectedTask.comment.commentDate  | date:'dd/MM/yyyy'}}</p>
        </div>
      </div>
    </div>
  </div>
</ng-template>
